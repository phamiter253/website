import{z as e,A as t,B as r,C as i,D as o,E as s,G as n,l as a,H as d,h as u,I as l,J as c,r as p,j as f,o as h,c as g,K as m,u as v,q as y,L as w}from"./DpZoubHd.js";async function b(e,t){const r=await async function(e){if("undefined"==typeof Image)throw new TypeError("Image not supported");return new Promise(((t,r)=>{const i=new Image;i.onload=()=>{const e={width:i.width,height:i.height,ratio:i.width/i.height};t(e)},i.onerror=e=>r(e),i.src=e}))}(t).catch((e=>({width:0,height:0,ratio:0})));return r}function q(e){return t=>t?e[t]||t:e.missingValue}function S(e=""){return"number"==typeof e?e:"string"==typeof e&&e.replace("px","").match(/^\d+$/g)?Number.parseInt(e,10):void 0}function x(e){const t={options:e},r=(e,r={})=>z(t,e,r),i=(e,t={},i={})=>r(e,{...i,modifiers:o(t,i.modifiers||{})}).url;for(const o in e.presets)i[o]=(t,r,s)=>i(t,r,{...e.presets[o],...s});return i.options=e,i.getImage=r,i.getMeta=(e,r)=>async function(e,t,r){const i=z(e,t,{...r});return"function"==typeof i.getMeta?await i.getMeta():await b(0,i.url)}(t,e,r),i.getSizes=(e,r)=>function(e,t,r){var i,o,s,n,a;const d=S(null==(i=r.modifiers)?void 0:i.width),u=S(null==(o=r.modifiers)?void 0:o.height),l=function(e){const t={};if("string"==typeof e)for(const r of e.split(/[\s,]+/).filter((e=>e))){const e=r.split(":");2!==e.length?t["1px"]=e[0].trim():t[e[0].trim()]=e[1].trim()}else Object.assign(t,e);return t}(r.sizes),c=(null==(s=r.densities)?void 0:s.trim())?function(e=""){if(void 0===e||!e.length)return[];const t=new Set;for(const r of e.split(" ")){const e=Number.parseInt(r.replace("x",""));e&&t.add(e)}return Array.from(t)}(r.densities.trim()):e.options.densities;!function(e){if(0===e.length)throw new Error("`densities` must not be empty, configure to `1` to render regular size only (DPR 1.0)")}(c);const p=d&&u?u/d:0,f=[],h=[];if(Object.keys(l).length>=1){for(const i in l){const o=_(i,String(l[i]),u,p,e);if(void 0!==o){f.push({size:o.size,screenMaxWidth:o.screenMaxWidth,media:`(max-width: ${o.screenMaxWidth}px)`});for(const i of c)h.push({width:o._cWidth*i,src:W(e,t,r,o,i)})}}!function(e){var t;e.sort(((e,t)=>e.screenMaxWidth-t.screenMaxWidth));let r=null;for(let i=e.length-1;i>=0;i--){const t=e[i];t.media===r&&e.splice(i,1),r=t.media}for(let i=0;i<e.length;i++)e[i].media=(null==(t=e[i+1])?void 0:t.media)||""}(f)}else for(const w of c){const i=Object.keys(l)[0];let o=i?_(i,String(l[i]),u,p,e):void 0;void 0===o&&(o={size:"",screenMaxWidth:0,_cWidth:null==(n=r.modifiers)?void 0:n.width,_cHeight:null==(a=r.modifiers)?void 0:a.height}),h.push({width:w,src:W(e,t,r,o,w)})}!function(e){e.sort(((e,t)=>e.width-t.width));let t=null;for(let r=e.length-1;r>=0;r--){const i=e[r];i.width===t&&e.splice(r,1),t=i.width}}(h);const g=h[h.length-1],m=f.length?f.map((e=>`${e.media?e.media+" ":""}${e.size}`)).join(", "):void 0,v=m?"w":"x",y=h.map((e=>`${e.src} ${e.width}${v}`)).join(", ");return{sizes:m,srcset:y,src:null==g?void 0:g.src}}(t,e,r),t.$img=i,i}function z(s,n,a){var d,u;if(n&&"string"!=typeof n)throw new TypeError(`input must be a string (received ${typeof n}: ${JSON.stringify(n)})`);if(!n||n.startsWith("data:"))return{url:n};const{provider:l,defaults:c}=function(e,t){const r=e.options.providers[t];if(!r)throw new Error("Unknown provider: "+t);return r}(s,a.provider||s.options.provider),p=function(e,t){if(!t)return{};if(!e.options.presets[t])throw new Error("Unknown preset: "+t);return e.options.presets[t]}(s,a.preset);if(n=e(n)?n:t(n),!l.supportsAlias)for(const e in s.options.alias)if(n.startsWith(e)){const t=s.options.alias[e];t&&(n=r(t,n.slice(e.length)))}if(l.validateDomains&&e(n)){const e=i(n).host;if(!s.options.domains.find((t=>t===e)))return{url:n}}const f=o(a,p,c);f.modifiers={...f.modifiers};const h=f.modifiers.format;(null==(d=f.modifiers)?void 0:d.width)&&(f.modifiers.width=S(f.modifiers.width)),(null==(u=f.modifiers)?void 0:u.height)&&(f.modifiers.height=S(f.modifiers.height));const g=l.getImage(n,f,s);return g.format=g.format||h||"",g}function _(e,t,r,i,o){const s=o.options.screens&&o.options.screens[e]||Number.parseInt(e),n=t.endsWith("vw");if(!n&&/^\d+$/.test(t)&&(t+="px"),!n&&!t.endsWith("px"))return;let a=Number.parseInt(t);if(!s||!a)return;n&&(a=Math.round(a/100*s));return{size:t,screenMaxWidth:s,_cWidth:a,_cHeight:i?Math.round(a*i):r}}function W(e,t,r,i,o){return e.$img(t,{...r.modifiers,width:i._cWidth?i._cWidth*o:void 0,height:i._cHeight?i._cHeight*o:void 0},r)}const $=function({formatter:e,keyMap:t,joinWith:r="/",valueMap:i}={}){e||(e=(e,t)=>`${e}=${t}`),t&&"function"!=typeof t&&(t=q(t));const o=i||{};return Object.keys(o).forEach((e=>{"function"!=typeof o[e]&&(o[e]=q(o[e]))})),(i={})=>Object.entries(i).filter((([e,t])=>void 0!==t)).map((([r,s])=>{const n=o[r];return"function"==typeof n&&(s=n(i[r])),r="function"==typeof t?t(r):r,e(r,s)})).join(r)}({keyMap:{format:"f",fit:"fit",width:"w",height:"h",resize:"s",quality:"q",background:"b"},joinWith:"&",formatter:(e,t)=>n(e)+"_"+n(t)}),j=Object.freeze(Object.defineProperty({__proto__:null,getImage:(e,{modifiers:t={},baseURL:i}={},o)=>{t.width&&t.height&&(t.resize=`${t.width}x${t.height}`,delete t.width,delete t.height);const n=$(t)||"_";return i||(i=r(o.options.nuxt.baseURL,"/_ipx")),{url:r(i,n,s(e))}},supportsAlias:!0,validateDomains:!0},Symbol.toStringTag,{value:"Module"})),k={screens:{xs:320,sm:640,md:768,lg:1024,xl:1280,xxl:1536,"2xl":1536},presets:{},provider:"ipxStatic",domains:[],alias:{},densities:[1,2],format:["webp","avif","webp"]};k.providers={ipxStatic:{provider:j,defaults:{}}};const M=()=>{const e=d(),t=a();return t.$img||t._img||(t._img=x({...k,nuxt:{baseURL:e.app.baseURL},runtimeConfig:e}))};const I={src:{type:String,required:!1},format:{type:String,required:!1},quality:{type:[Number,String],required:!1},background:{type:String,required:!1},fit:{type:String,required:!1},modifiers:{type:Object,required:!1},preset:{type:String,required:!1},provider:{type:String,required:!1},sizes:{type:[Object,String],required:!1},densities:{type:String,required:!1},preload:{type:[Boolean,Object],required:!1},width:{type:[String,Number],required:!1},height:{type:[String,Number],required:!1},alt:{type:String,required:!1},referrerpolicy:{type:String,required:!1},usemap:{type:String,required:!1},longdesc:{type:String,required:!1},ismap:{type:Boolean,required:!1},loading:{type:String,required:!1,validator:e=>["lazy","eager"].includes(e)},crossorigin:{type:[Boolean,String],required:!1,validator:e=>["anonymous","use-credentials","",!0,!1].includes(e)},decoding:{type:String,required:!1,validator:e=>["async","auto","sync"].includes(e)},nonce:{type:[String],required:!1}},A={...I,placeholder:{type:[Boolean,String,Number,Array],required:!1},placeholderClass:{type:String,required:!1},custom:{type:Boolean,required:!1}},O=["src"],E=l({__name:"NuxtImg",props:A,emits:["load","error"],setup(e,{emit:t}){const r=e,i=c(),o=t,s=!1,n=M(),d=(e=>{const t=u((()=>({provider:e.provider,preset:e.preset}))),r=u((()=>({width:S(e.width),height:S(e.height),alt:e.alt,referrerpolicy:e.referrerpolicy,usemap:e.usemap,longdesc:e.longdesc,ismap:e.ismap,crossorigin:!0===e.crossorigin?"anonymous":e.crossorigin||void 0,loading:e.loading,decoding:e.decoding,nonce:e.nonce}))),i=M();return{options:t,attrs:r,modifiers:u((()=>({...e.modifiers,width:S(e.width),height:S(e.height),format:e.format,quality:e.quality||i.options.quality,background:e.background,fit:e.fit})))}})(r),l=p(!1),b=p(),q=u((()=>n.getSizes(r.src,{...d.options.value,sizes:r.sizes,densities:r.densities,modifiers:{...d.modifiers.value,width:S(r.width),height:S(r.height)}}))),x=u((()=>{const e={...d.attrs.value,"data-nuxt-img":""};return r.placeholder&&!l.value||(e.sizes=q.value.sizes,e.srcset=q.value.srcset),e})),z=u((()=>{let e=r.placeholder;if(""===e&&(e=!0),!e||l.value)return!1;if("string"==typeof e)return e;const t=Array.isArray(e)?e:"number"==typeof e?[e,e]:[10,10];return n(r.src,{...d.modifiers.value,width:t[0],height:t[1],quality:t[2]||50,blur:t[3]||3},d.options.value)})),_=u((()=>r.sizes?q.value.src:n(r.src,d.modifiers.value,d.options.value))),W=u((()=>z.value?z.value:_.value)),$=a().isHydrating;return f((()=>{if(z.value||r.custom){const i=new Image;return _.value&&(i.src=_.value),r.sizes&&(i.sizes=q.value.sizes||"",i.srcset=q.value.srcset),i.onload=e=>{l.value=!0,o("load",e)},i.onerror=e=>{o("error",e)},e="nuxt-image",void(null==(t=null==performance?void 0:performance.mark)||t.call(performance,"mark_feature_usage",{detail:{feature:e}}))}var e,t;b.value&&(b.value.complete&&$&&(b.value.getAttribute("data-error")?o("error",new Event("error")):o("load",new Event("load"))),b.value.onload=e=>{o("load",e)},b.value.onerror=e=>{o("error",e)})})),(e,t)=>e.custom?y(e.$slots,"default",w(m({key:1},{...v(s)?{onerror:"this.setAttribute('data-error', 1)"}:{},imgAttrs:{...x.value,...v(i)},isLoaded:l.value,src:W.value}))):(h(),g("img",m({key:0,ref_key:"imgEl",ref:b,class:r.placeholder&&!l.value?r.placeholderClass:void 0},{...v(s)?{onerror:"this.setAttribute('data-error', 1)"}:{},...x.value,...v(i)},{src:W.value}),null,16,O))}});export{E as _};
